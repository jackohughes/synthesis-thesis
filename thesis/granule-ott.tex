% generated by Ott 0.31 from: ../granule.ott
\newcommand{\GRANULEdrule}[4][]{{\displaystyle\frac{\begin{array}{l}#2\end{array}}{#3}\quad\GRANULEdrulename{#4}}}
\newcommand{\GRANULEusedrule}[1]{\[#1\]}
\newcommand{\GRANULEpremise}[1]{ #1 \\}
\newenvironment{GRANULEdefnblock}[3][]{ \framebox{\mbox{#2}} \quad #3 \\[0pt]}{}
\newenvironment{GRANULEfundefnblock}[3][]{ \framebox{\mbox{#2}} \quad #3 \\[0pt]\begin{displaymath}\begin{array}{l}}{\end{array}\end{displaymath}}
\newcommand{\GRANULEfunclause}[2]{ #1 \equiv #2 \\}
\newcommand{\GRANULEnt}[1]{\mathit{#1}}
\newcommand{\GRANULEmv}[1]{\mathit{#1}}
\newcommand{\GRANULEkw}[1]{\mathbf{#1}}
\newcommand{\GRANULEsym}[1]{#1}
\newcommand{\GRANULEcom}[1]{\text{#1}}
\newcommand{\GRANULEdrulename}[1]{\textsc{#1}}
\newcommand{\GRANULEcomplu}[5]{\overline{#1}^{\,#2\in #3 #4 #5}}
\newcommand{\GRANULEcompu}[3]{\overline{#1}^{\,#2<#3}}
\newcommand{\GRANULEcomp}[2]{\overline{#1}^{\,#2}}
\newcommand{\GRANULEgrammartabular}[1]{\begin{supertabular}{llcllllll}#1\end{supertabular}}
\newcommand{\GRANULEmetavartabular}[1]{\begin{supertabular}{ll}#1\end{supertabular}}
\newcommand{\GRANULErulehead}[3]{$#1$ & & $#2$ & & & \multicolumn{2}{l}{#3}}
\newcommand{\GRANULEprodline}[6]{& & $#1$ & $#2$ & $#3 #4$ & $#5$ & $#6$}
\newcommand{\GRANULEfirstprodline}[6]{\GRANULEprodline{#1}{#2}{#3}{#4}{#5}{#6}}
\newcommand{\GRANULElongprodline}[2]{& & $#1$ & \multicolumn{4}{l}{$#2$}}
\newcommand{\GRANULEfirstlongprodline}[2]{\GRANULElongprodline{#1}{#2}}
\newcommand{\GRANULEbindspecprodline}[6]{\GRANULEprodline{#1}{#2}{#3}{#4}{#5}{#6}}
\newcommand{\GRANULEprodnewline}{\\}
\newcommand{\GRANULEinterrule}{\\[5.0mm]}
\newcommand{\GRANULEafterlastrule}{\\}

\IfFileExists{xcolor.sty}{
	\RequirePackage{xcolor}
}{
	\RequirePackage{color}
}


 \usepackage{stmaryrd}
 \usepackage{mathtools}
 \usepackage{halloweenmath}
 %\definecolor{coeffectColor}{HTML}{0750D0}
 \definecolor{coeffectColor}{HTML}{000000}
 \definecolor{effectColor}{HTML}{D64800}

 
\newcommand{\GRANULEmetavars}{
\GRANULEmetavartabular{
 $ \GRANULEmv{termvar} ,\, \alpha ,\, \beta ,\, \gamma ,\, \mathcal{L} ,\, \GRANULEmv{x} ,\, \GRANULEmv{y} ,\, \GRANULEmv{z} ,\, \GRANULEmv{f} ,\, \GRANULEmv{g} ,\, \GRANULEmv{h} ,\, \mathit{adv} $ &  \\
 $ \GRANULEmv{index} ,\, \GRANULEmv{i} ,\, \GRANULEmv{j} ,\, \GRANULEmv{n} ,\, \GRANULEmv{m} $ &  \\
}}

\newcommand{\GRANULEFoc}{
\GRANULErulehead{\GRANULEnt{Foc}}{::=}{\GRANULEcom{Focusing phase}}\GRANULEprodnewline
\GRANULEfirstprodline{|}{ \textsc{A} }{}{}{}{\GRANULEcom{Async}}\GRANULEprodnewline
\GRANULEprodline{|}{ \textsc{S} }{}{}{}{\GRANULEcom{Sync}}}

\newcommand{\GRANULEt}{
\GRANULErulehead{\GRANULEnt{t}  ,\ \GRANULEnt{v}}{::=}{\GRANULEcom{Terms}}\GRANULEprodnewline
\GRANULEfirstprodline{|}{\GRANULEnt{t_{{\mathrm{1}}}} \, \GRANULEnt{t_{{\mathrm{2}}}}}{}{}{}{\GRANULEcom{Application}}\GRANULEprodnewline
\GRANULEprodline{|}{ \textbf{let} \, \langle  \GRANULEnt{p}  \rangle\!\shortleftarrow\!  \GRANULEnt{t_{{\mathrm{1}}}}  \, \textbf{in} \,  \GRANULEnt{t_{{\mathrm{2}}}} }{}{}{}{\GRANULEcom{Effectful Let Binding}}\GRANULEprodnewline
\GRANULEprodline{|}{ \textbf{case} \  \GRANULEnt{t}  \ \textbf{of} \  \GRANULEnt{Cases} }{}{}{}{\GRANULEcom{Case}}\GRANULEprodnewline
\GRANULEprodline{|}{ \lambda  \GRANULEnt{p}  .  \GRANULEnt{t} }{}{}{}{\GRANULEcom{Function}}\GRANULEprodnewline
\GRANULEprodline{|}{ \lambda  \GRANULEnt{p}  .  \GRANULEnt{t} }{}{}{}{\GRANULEcom{Function with graded annotation on its binder}}\GRANULEprodnewline
\GRANULEprodline{|}{\GRANULEsym{[}  \GRANULEnt{t}  \GRANULEsym{]}}{}{}{}{\GRANULEcom{Promote}}\GRANULEprodnewline
\GRANULEprodline{|}{\langle  \GRANULEnt{t}  \rangle}{}{}{}{\GRANULEcom{Pure}}\GRANULEprodnewline
\GRANULEprodline{|}{\GRANULEmv{x}}{}{}{}{\GRANULEcom{Variable}}\GRANULEprodnewline
\GRANULEprodline{|}{C \, \GRANULEnt{t_{{\mathrm{0}}}} \, ... \, \GRANULEnt{t_{\GRANULEmv{n}}}}{}{}{}{\GRANULEcom{Constructor}}\GRANULEprodnewline
\GRANULEprodline{|}{ C }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{\GRANULEmv{n}}{}{}{}{\GRANULEcom{Integer constructors}}\GRANULEprodnewline
\GRANULEprodline{|}{ \textbf{let} \, [  \GRANULEnt{p}  ] =  \GRANULEnt{t_{{\mathrm{1}}}}  \, \textbf{in} \,  \GRANULEnt{t_{{\mathrm{2}}}} } {\textsf{S}}{}{}{\GRANULEcom{Modal let-binding}}\GRANULEprodnewline
\GRANULEprodline{|}{ ( \GRANULEnt{t_{{\mathrm{1}}}} ,  \GRANULEnt{t_{{\mathrm{2}}}} ) }{}{}{}{\GRANULEcom{A pair of terms}}\GRANULEprodnewline
\GRANULEprodline{|}{ - }{}{}{}{\GRANULEcom{Hole}}}

\newcommand{\GRANULECon}{
\GRANULErulehead{C}{::=}{\GRANULEcom{Constructors}}\GRANULEprodnewline
\GRANULEfirstprodline{|}{\GRANULEsym{(,)}}{}{}{}{\GRANULEcom{Pair constructor}}\GRANULEprodnewline
\GRANULEprodline{|}{\GRANULEkw{inl}}{}{}{}{\GRANULEcom{Left injection}}\GRANULEprodnewline
\GRANULEprodline{|}{\GRANULEkw{inr}}{}{}{}{\GRANULEcom{Right injection}}\GRANULEprodnewline
\GRANULEprodline{|}{ \mathsf{unit} }{}{}{}{\GRANULEcom{Unit}}\GRANULEprodnewline
\GRANULEprodline{|}{ \mathsf{tt} }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ \mathsf{ff} }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ \mathsf{Just} }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ \mathsf{Nothing} }{}{}{}{}}

\newcommand{\GRANULECases}{
\GRANULErulehead{\GRANULEnt{Cases}}{::=}{\GRANULEcom{Value-level cases}}\GRANULEprodnewline
\GRANULEfirstprodline{|}{\GRANULEnt{p}  \rightarrow  \GRANULEnt{t}  \GRANULEsym{;}  \GRANULEnt{Cases}}{}{}{}{\GRANULEcom{Case cons}}\GRANULEprodnewline
\GRANULEprodline{|}{\GRANULEnt{p}  \rightarrow  \GRANULEnt{t}}{}{}{}{\GRANULEcom{One case}}\GRANULEprodnewline
\GRANULEprodline{|}{ \overline{  \GRANULEnt{p}  \mapsto  \GRANULEnt{t} } }{}{}{}{\GRANULEcom{One case overline}}\GRANULEprodnewline
\GRANULEprodline{|}{ \GRANULEnt{p}  \mapsto  \GRANULEnt{t} ; ... ;  \GRANULEnt{p'}  \mapsto  \GRANULEnt{t'} } {\textsf{S}}{}{}{\GRANULEcom{Many cases (syntactic sugar)}}}

\newcommand{\GRANULEp}{
\GRANULErulehead{\GRANULEnt{p}}{::=}{\GRANULEcom{Patterns}}\GRANULEprodnewline
\GRANULEfirstprodline{|}{\GRANULEmv{x}}{}{}{}{\GRANULEcom{Variable}}\GRANULEprodnewline
\GRANULEprodline{|}{ \_ }{}{}{}{\GRANULEcom{Wildcard}}\GRANULEprodnewline
\GRANULEprodline{|}{\GRANULEsym{[}  \GRANULEnt{p}  \GRANULEsym{]}}{}{}{}{\GRANULEcom{Unbox}}\GRANULEprodnewline
\GRANULEprodline{|}{ \lbrack [  \GRANULEnt{p}  ] \rbrack }{}{}{}{\GRANULEcom{Double unboxing}}\GRANULEprodnewline
\GRANULEprodline{|}{C \, \GRANULEnt{p_{{\mathrm{1}}}} \, ... \, \GRANULEnt{p_{\GRANULEmv{n}}}}{}{}{}{\GRANULEcom{Constructor}}\GRANULEprodnewline
\GRANULEprodline{|}{ C  \  \GRANULEnt{p_{{\mathrm{1}}}} ^ \GRANULEnt{Ix_{{\mathrm{3}}}} _ \GRANULEnt{Ix_{{\mathrm{1}}}}  ...  \GRANULEnt{p_{{\mathrm{2}}}} ^ \GRANULEnt{Ix_{{\mathrm{3}}}} _ \GRANULEnt{Ix_{{\mathrm{2}}}} }{}{}{}{\GRANULEcom{ConstructorIndexed}}\GRANULEprodnewline
\GRANULEprodline{|}{ C }{}{}{}{\GRANULEcom{Nullary Constructor}}\GRANULEprodnewline
\GRANULEprodline{|}{\GRANULEmv{n}}{}{}{}{\GRANULEcom{Int constructor}}\GRANULEprodnewline
\GRANULEprodline{|}{\GRANULEsym{(}  \GRANULEnt{p}  \GRANULEsym{)}}{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ \GRANULEmv{y} ^i_j }{}{}{}{\GRANULEcom{Hack}}\GRANULEprodnewline
\GRANULEprodline{|}{ ( \GRANULEnt{p_{{\mathrm{1}}}} ,  \GRANULEnt{p_{{\mathrm{2}}}} ) }{}{}{}{\GRANULEcom{Pair}}\GRANULEprodnewline
\GRANULEprodline{|}{ \GRANULEnt{p} ^{ \GRANULEnt{Ix} } } {\textsf{S}}{}{}{\GRANULEcom{Pattern at index n+m}}}

\newcommand{\GRANULEIx}{
\GRANULErulehead{\GRANULEnt{Ix}}{::=}{\GRANULEcom{More complex index expressions}}\GRANULEprodnewline
\GRANULEfirstprodline{|}{\GRANULEsym{0}}{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{\GRANULEsym{1}}{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{\GRANULEsym{2}}{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{\GRANULEnt{Ix_{{\mathrm{1}}}}  \GRANULEsym{+}  \GRANULEnt{Ix_{{\mathrm{2}}}}}{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ m }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ 1 }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ 2 }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ 3 }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ 4 }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ i }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ j }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ n }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ m }{}{}{}{}}

\newcommand{\GRANULEEqn}{
\GRANULErulehead{\GRANULEnt{Eqn}}{::=}{\GRANULEcom{Equations}}\GRANULEprodnewline
\GRANULEfirstprodline{|}{\GRANULEmv{x} \, \GRANULEnt{p_{{\mathrm{1}}}} \, .. \, \GRANULEnt{p_{\GRANULEmv{n}}}  \GRANULEsym{=}  \GRANULEnt{t}}{}{}{}{\GRANULEcom{Eq}}}

\newcommand{\GRANULEDef}{
\GRANULErulehead{\textit{Def}}{::=}{\GRANULEcom{Definitions}}\GRANULEprodnewline
\GRANULEfirstprodline{|}{\GRANULEmv{x}  \GRANULEsym{:}  C  \GRANULEsym{;}  \GRANULEnt{Eqn_{{\mathrm{1}}}} \, .. \, \GRANULEnt{Eqn_{\GRANULEmv{n}}}}{}{}{}{\GRANULEcom{Multi-eq def}}}

\newcommand{\GRANULEA}{
\GRANULErulehead{\GRANULEnt{A}  ,\ \GRANULEnt{B}  ,\ \GRANULEnt{C}  ,\ \GRANULEnt{E}  ,\ \GRANULEnt{W}  ,\ C}{::=}{\GRANULEcom{Types}}\GRANULEprodnewline
\GRANULEfirstprodline{|}{ \cdot }{}{}{}{\GRANULEcom{Empty}}\GRANULEprodnewline
\GRANULEprodline{|}{\GRANULEnt{A}  \rightarrow  \GRANULEnt{B}}{}{}{}{\GRANULEcom{Function}}\GRANULEprodnewline
\GRANULEprodline{|}{ \GRANULEnt{A} _{ \textsc{Dec} } }{}{}{}{\GRANULEcom{Dec}}\GRANULEprodnewline
\GRANULEprodline{|}{ \GRANULEnt{A} ^ \GRANULEnt{c}  \rightarrow  \GRANULEnt{B} }{}{}{}{\GRANULEcom{Graded Function}}\GRANULEprodnewline
\GRANULEprodline{|}{ \GRANULEnt{A} ^ \GRANULEnt{c}  \multimap  \GRANULEnt{B} }{}{}{}{\GRANULEcom{Graded Linear Function}}\GRANULEprodnewline
\GRANULEprodline{|}{ \GRANULEnt{A}  \multimap  \GRANULEnt{B} } {\textsf{S}}{}{}{\GRANULEcom{Linear Function}}\GRANULEprodnewline
\GRANULEprodline{|}{ K }{}{}{}{\GRANULEcom{Constructor}}\GRANULEprodnewline
\GRANULEprodline{|}{ K  \GRANULEnt{A}  \ldots  \GRANULEnt{B} }{}{}{}{\GRANULEcom{Constructor}}\GRANULEprodnewline
\GRANULEprodline{|}{\alpha}{}{}{}{\GRANULEcom{Variable}}\GRANULEprodnewline
\GRANULEprodline{|}{\GRANULEnt{A} \, \GRANULEnt{B}}{}{}{}{\GRANULEcom{Application}}\GRANULEprodnewline
\GRANULEprodline{|}{ \GRANULEnt{A} ^ \GRANULEnt{Ix_{{\mathrm{1}}}} _ \GRANULEnt{Ix_{{\mathrm{2}}}} }{}{}{}{\GRANULEcom{Var2IndexTy}}\GRANULEprodnewline
\GRANULEprodline{|}{ \Box  \GRANULEnt{A} }{}{}{}{\GRANULEcom{BlankBox}}\GRANULEprodnewline
\GRANULEprodline{|}{ \Box_{  \GRANULEnt{c}  }  \GRANULEnt{A} }{}{}{}{\GRANULEcom{Box}}\GRANULEprodnewline
\GRANULEprodline{|}{ \Box_{\textcolor{coeffectColor}{ \GRANULEnt{c}  :  \GRANULEnt{B} } }  \GRANULEnt{A} }{}{}{}{\GRANULEcom{Box with coeffect type}}\GRANULEprodnewline
\GRANULEprodline{|}{ \mathsf{Int} }{}{}{}{\GRANULEcom{Integers}}\GRANULEprodnewline
\GRANULEprodline{|}{ \mathsf{Char} }{}{}{}{\GRANULEcom{Characters}}\GRANULEprodnewline
\GRANULEprodline{|}{ \mathsf{Unit} }{}{}{}{\GRANULEcom{unit}}\GRANULEprodnewline
\GRANULEprodline{|}{ \otimes }{}{}{}{\GRANULEcom{Products}}\GRANULEprodnewline
\GRANULEprodline{|}{ \mathbb{B} }{}{}{}{\GRANULEcom{Bool}}\GRANULEprodnewline
\GRANULEprodline{|}{ \mathsf{IO} }{}{}{}{\GRANULEcom{IO}}\GRANULEprodnewline
\GRANULEprodline{|}{\GRANULEnt{R}}{}{}{}{\GRANULEcom{Coeffect types}}\GRANULEprodnewline
\GRANULEprodline{|}{\GRANULEmv{n}}{}{}{}{\GRANULEcom{Type-level integers}}\GRANULEprodnewline
\GRANULEprodline{|}{ \GRANULEnt{A}  \,  \textsf{op} 
  \,  \GRANULEnt{B} }{}{}{}{\GRANULEcom{InfixOp}}\GRANULEprodnewline
\GRANULEprodline{|}{ ( \GRANULEnt{A}  \, \times \,  \GRANULEnt{B} ) }{}{}{}{\GRANULEcom{Tuple}}\GRANULEprodnewline
\GRANULEprodline{|}{ ( \GRANULEnt{A}  \, + \,  \GRANULEnt{B} ) }{}{}{}{\GRANULEcom{Sum}}\GRANULEprodnewline
\GRANULEprodline{|}{ \{  \GRANULEnt{A_{{\mathrm{1}}}} , ...,   \GRANULEnt{A_{\GRANULEmv{n}}}  \} }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ {\downarrow\! \kappa  } }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ \mathsf{Set} \,  \GRANULEnt{A} }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ \GRANULEnt{B_{{\mathrm{1}}}} ^1  \rightarrow \! ... \! \rightarrow   \GRANULEnt{B_{\GRANULEmv{n}}} ^1  \rightarrow   \GRANULEnt{A} } {\textsf{S}}{}{}{\GRANULEcom{n-Ary Function}}\GRANULEprodnewline
\GRANULEprodline{|}{ \GRANULEnt{B_{{\mathrm{1}}}} ^{q_1}  \rightarrow \! ... \! \rightarrow   \GRANULEnt{B_{\GRANULEmv{n}}} ^{q_n}  \rightarrow   \GRANULEnt{A} } {\textsf{S}}{}{}{\GRANULEcom{n-Ary Function w grades}}}

\newcommand{\GRANULEop}{
\GRANULErulehead{\textsf{op}}{::=}{\GRANULEcom{Type operators}}\GRANULEprodnewline
\GRANULEfirstprodline{|}{ + }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ * }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ - }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ \leq }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ < }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ > }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ \geq }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ = }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ \neq }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ \sqcup }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ \sqcap }{}{}{}{}}

\newcommand{\GRANULER}{
\GRANULErulehead{\GRANULEnt{R}  ,\ \GRANULEnt{S}}{::=}{\GRANULEcom{Coeffect types}}\GRANULEprodnewline
\GRANULEfirstprodline{|}{ \mathsf{Nat} }{}{}{}{\GRANULEcom{Nat}}\GRANULEprodnewline
\GRANULEprodline{|}{ \mathsf{Level} }{}{}{}{\GRANULEcom{Level}}\GRANULEprodnewline
\GRANULEprodline{|}{ \mathsf{Ext} }{}{}{}{\GRANULEcom{Extending}}\GRANULEprodnewline
\GRANULEprodline{|}{ \mathsf{Interval} }{}{}{}{\GRANULEcom{Interval}}\GRANULEprodnewline
\GRANULEprodline{|}{ \GRANULEnt{A}  \times  \GRANULEnt{B} }{}{}{}{\GRANULEcom{Products}}\GRANULEprodnewline
\GRANULEprodline{|}{\GRANULEnt{R} \, \GRANULEnt{S}}{}{}{}{\GRANULEcom{Application}}\GRANULEprodnewline
\GRANULEprodline{|}{ \alpha }{}{}{}{\GRANULEcom{Variable}}\GRANULEprodnewline
\GRANULEprodline{|}{ \beta }{}{}{}{\GRANULEcom{VariableB}}}

\newcommand{\GRANULEConstraints}{
\GRANULErulehead{\textit{Cons}}{::=}{\GRANULEcom{Constraints/Predicates}}\GRANULEprodnewline
\GRANULEfirstprodline{|}{\GRANULEnt{A}  \GRANULEsym{,}  \textit{Cons}}{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{\GRANULEnt{A}}{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{\GRANULEnt{A_{{\mathrm{1}}}}  \GRANULEsym{,} \, .. \, \GRANULEsym{,}  \GRANULEnt{A_{\GRANULEmv{n}}}}{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ \overrightarrow{ \GRANULEnt{A} } }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{\GRANULEsym{(}  \textit{Cons}  \GRANULEsym{)}}{}{}{}{}}

\newcommand{\GRANULEc}{
\GRANULErulehead{\GRANULEnt{c}  ,\ \GRANULEnt{r}  ,\ \GRANULEnt{s}  ,\ \GRANULEnt{q}}{::=}{}\GRANULEprodnewline
\GRANULEfirstprodline{|}{ \GRANULEnt{c} ^ \GRANULEnt{Ix_{{\mathrm{1}}}} _ \GRANULEnt{Ix_{{\mathrm{2}}}} }{}{}{}{\GRANULEcom{Var2Index}}\GRANULEprodnewline
\GRANULEprodline{|}{ \GRANULEnt{c} _ \GRANULEnt{Ix_{{\mathrm{1}}}} }{}{}{}{\GRANULEcom{Var1Index}}\GRANULEprodnewline
\GRANULEprodline{|}{\GRANULEnt{c_{{\mathrm{1}}}}  \GRANULEsym{+}  \GRANULEnt{c_{{\mathrm{2}}}}}{}{}{}{\GRANULEcom{Addition}}\GRANULEprodnewline
\GRANULEprodline{|}{\GRANULEnt{c_{{\mathrm{1}}}}  \textcolor{coeffectColor}{\,\cdot\,}  \GRANULEnt{c_{{\mathrm{2}}}}}{}{}{}{\GRANULEcom{Multiplication}}\GRANULEprodnewline
\GRANULEprodline{|}{ 0 }{}{}{}{\GRANULEcom{Additive Unit}}\GRANULEprodnewline
\GRANULEprodline{|}{ 1 }{}{}{}{\GRANULEcom{Multiplicative Unit}}\GRANULEprodnewline
\GRANULEprodline{|}{ \GRANULEnt{c_{{\mathrm{1}}}}  \sqcup  \GRANULEnt{c_{{\mathrm{2}}}} }{}{}{}{\GRANULEcom{Join}}\GRANULEprodnewline
\GRANULEprodline{|}{ \GRANULEnt{c_{{\mathrm{1}}}}  \sqcap  \GRANULEnt{c_{{\mathrm{2}}}} }{}{}{}{\GRANULEcom{Meet}}\GRANULEprodnewline
\GRANULEprodline{|}{ \GRANULEnt{c_{{\mathrm{1}}}}  \sqcap ... \sqcap  \GRANULEnt{c_{{\mathrm{2}}}} }{}{}{}{\GRANULEcom{MultiMeet}}\GRANULEprodnewline
\GRANULEprodline{|}{ \GRANULEnt{c_{{\mathrm{1}}}}  \sqcup ... \sqcup  \GRANULEnt{c_{{\mathrm{2}}}} }{}{}{}{\GRANULEcom{MultiJoin}}\GRANULEprodnewline
\GRANULEprodline{|}{ \GRANULEnt{c_{{\mathrm{1}}}}  =  \GRANULEnt{c_{{\mathrm{2}}}} }{}{}{}{\GRANULEcom{CoeffEq}}\GRANULEprodnewline
\GRANULEprodline{|}{ \bigsqcup_1^n  \GRANULEnt{c} }{}{}{}{\GRANULEcom{BigJoin}}\GRANULEprodnewline
\GRANULEprodline{|}{ \textsf{flatten}  ( \GRANULEnt{c_{{\mathrm{1}}}} ,  \GRANULEnt{A} ,  \GRANULEnt{c_{{\mathrm{2}}}} ,  \GRANULEnt{B} ) }{}{}{}{\GRANULEcom{Flatten}}\GRANULEprodnewline
\GRANULEprodline{|}{ \textcolor{coeffectColor}{ \GRANULEnt{c_{{\mathrm{1}}}} }..\textcolor{coeffectColor}{ \GRANULEnt{c_{{\mathrm{2}}}} } }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ \infty }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ ( \GRANULEnt{c_{{\mathrm{1}}}} ,  \GRANULEnt{c_{{\mathrm{2}}}} ) }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ \theta   \GRANULEnt{c} }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{\GRANULEsym{2}} {\textsf{S}}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{\GRANULEsym{3}} {\textsf{S}}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{\GRANULEsym{4}} {\textsf{S}}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ \GRANULEnt{c} _{i - 1} }{}{}{}{}}

\newcommand{\GRANULERel}{
\GRANULErulehead{\GRANULEnt{Rel}}{::=}{\GRANULEcom{Relations on grades}}\GRANULEprodnewline
\GRANULEfirstprodline{|}{ \GRANULEnt{c_{{\mathrm{1}}}}  \sqsubseteq  \GRANULEnt{c_{{\mathrm{2}}}} }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ \GRANULEnt{c_{{\mathrm{1}}}}  \sqsubseteq  \GRANULEnt{c_{{\mathrm{2}}}}  \sqsubseteq  \GRANULEnt{c_{{\mathrm{3}}}} }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ \GRANULEnt{c_{{\mathrm{1}}}}  \sqsupseteq  \GRANULEnt{c_{{\mathrm{2}}}} }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ \GRANULEnt{c_{{\mathrm{1}}}}  \sqsupseteq  \GRANULEnt{c_{{\mathrm{2}}}}  \sqsupseteq  \GRANULEnt{c_{{\mathrm{3}}}} }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ \GRANULEnt{Rel_{{\mathrm{1}}}}  \wedge  \GRANULEnt{Rel_{{\mathrm{2}}}} }{}{}{}{}}

\newcommand{\GRANULEk}{
\GRANULErulehead{\kappa}{::=}{}\GRANULEprodnewline
\GRANULEfirstprodline{|}{ \mathsf{Type} }{}{}{}{\GRANULEcom{Type}}\GRANULEprodnewline
\GRANULEprodline{|}{ {\uparrow\! \GRANULEnt{A}  } }{}{}{}{\GRANULEcom{Promote a type to a kind}}\GRANULEprodnewline
\GRANULEprodline{|}{ \mathsf{Effect} }{}{}{}{\GRANULEcom{Effect grades}}\GRANULEprodnewline
\GRANULEprodline{|}{ \mathsf{Coeffect} }{}{}{}{\GRANULEcom{Coeffect grades}}\GRANULEprodnewline
\GRANULEprodline{|}{ \mathsf{Eff} }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ \mathsf{Coeff} }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ \mathsf{(Co)eff} }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ \mathsf{Predicate} }{}{}{}{\GRANULEcom{Predicates}}\GRANULEprodnewline
\GRANULEprodline{|}{\kappa_{{\mathrm{1}}}  \rightarrow  \kappa_{{\mathrm{2}}}}{}{}{}{\GRANULEcom{Kind function}}\GRANULEprodnewline
\GRANULEprodline{|}{ \kappa_{{\mathrm{1}}}  \cup  \kappa_{{\mathrm{2}}} }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ \theta \kappa }{}{}{}{\GRANULEcom{Substitutions}}\GRANULEprodnewline
\GRANULEprodline{|}{\GRANULEsym{(}  \kappa  \GRANULEsym{)}}{}{}{}{}}

\newcommand{\GRANULEDefines}{
\GRANULErulehead{D}{::=}{}\GRANULEprodnewline
\GRANULEfirstprodline{|}{ \emptyset }{}{}{}{\GRANULEcom{Empty}}\GRANULEprodnewline
\GRANULEprodline{|}{D_{{\mathrm{1}}}  \GRANULEsym{,}  D_{{\mathrm{2}}}}{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{\GRANULEsym{(}  D  \GRANULEsym{)}}{}{}{}{}}

\newcommand{\GRANULEAss}{
\GRANULErulehead{As}{::=}{}\GRANULEprodnewline
\GRANULEfirstprodline{|}{ \GRANULEmv{x}  :  C }{}{}{}{\GRANULEcom{Singleton context}}\GRANULEprodnewline
\GRANULEprodline{|}{ \GRANULEmv{x}  :_{\textcolor{coeffectColor}{  \GRANULEnt{r}  } }   C }{}{}{}{\GRANULEcom{Singleton context w/ graded assumption}}\GRANULEprodnewline
\GRANULEprodline{|}{ {  \GRANULEmv{x} ^ \GRANULEnt{Ix_{{\mathrm{1}}}} _ \GRANULEnt{Ix_{{\mathrm{2}}}}  }:_{\textcolor{coeffectColor}{  \GRANULEnt{c}  } }   C }{}{}{}{\GRANULEcom{Indexed Variable}}\GRANULEprodnewline
\GRANULEprodline{|}{ {  \GRANULEmv{x} ^ \GRANULEnt{Ix_{{\mathrm{1}}}}  }:_{\textcolor{coeffectColor}{  \GRANULEnt{c}  } }   C }{}{}{}{\GRANULEcom{Indexed Variable 1}}}

\newcommand{\GRANULEG}{
\GRANULErulehead{\Gamma  ,\ \Delta  ,\ \Omega}{::=}{}\GRANULEprodnewline
\GRANULEfirstprodline{|}{ \emptyset }{}{}{}{\GRANULEcom{Empty}}\GRANULEprodnewline
\GRANULEprodline{|}{As}{}{}{}{\GRANULEcom{Single assumption}}}

\newcommand{\GRANULECoeffInfo}{
\GRANULErulehead{\textit{r} :? \textit{R}}{::=}{}\GRANULEprodnewline
\GRANULEfirstprodline{|}{ \GRANULEnt{c} }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ - }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{\GRANULEsym{(}  \textit{r} :? \textit{R}  \GRANULEsym{)}}{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ \theta \textit{r} :? \textit{R} }{}{}{}{}}

\newcommand{\GRANULEP}{
\GRANULErulehead{P}{::=}{}\GRANULEprodnewline
\GRANULEfirstprodline{|}{ P_{{\mathrm{1}}}  \wedge  P_{{\mathrm{2}}} }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ P_{{\mathrm{1}}}  \wedge\!...\!\wedge  P_{\GRANULEmv{n}} }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ P_{{\mathrm{1}}}  \vee  P_{{\mathrm{2}}} }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ P_{{\mathrm{1}}}  \rightarrow  P_{{\mathrm{2}}} }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ \forall  \alpha  .  P }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ \neg  P }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ \exists  \alpha  .  P }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ \mathbf{t}_{{\mathrm{1}}}  \equiv  \mathbf{t}_{{\mathrm{2}}} }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ \mathbf{t}_{{\mathrm{1}}}  \sqsubseteq  \mathbf{t}_{{\mathrm{2}}} }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ \top }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{\GRANULEsym{(}  P  \GRANULEsym{)}}{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ \llbracket{ \theta }\rrbracket }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ \llbracket{ \textit{Cons} }\rrbracket }{}{}{}{}}

\newcommand{\GRANULEComp}{
\GRANULErulehead{\mathbf{t}}{::=}{}\GRANULEprodnewline
\GRANULEfirstprodline{|}{ \llbracket{\textcolor{coeffectColor}{ \GRANULEnt{c} } }\rrbracket }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ \llbracket{\textcolor{coeffectColor}{ \GRANULEnt{A}  } }\rrbracket }{}{}{}{}}

\newcommand{\GRANULETh}{
\GRANULErulehead{\theta  ,\ \theta_\kappa}{::=}{}\GRANULEprodnewline
\GRANULEfirstprodline{|}{ \emptyset }{}{}{}{\GRANULEcom{Empty}}\GRANULEprodnewline
\GRANULEprodline{|}{ \theta_{{\mathrm{1}}}  \uplus  \theta_{{\mathrm{2}}} }{}{}{}{\GRANULEcom{Union}}\GRANULEprodnewline
\GRANULEprodline{|}{\GRANULEmv{x}  \mapsto  \GRANULEnt{B}}{}{}{}{\GRANULEcom{SingletonTy}}\GRANULEprodnewline
\GRANULEprodline{|}{\GRANULEmv{x}  \mapsto  \kappa}{}{}{}{\GRANULEcom{SingletonKind}}\GRANULEprodnewline
\GRANULEprodline{|}{\GRANULEmv{x}  \mapsto  \GRANULEnt{c}}{}{}{}{\GRANULEcom{Singleton Coeffect}}\GRANULEprodnewline
\GRANULEprodline{|}{ \theta   \theta' }{}{}{}{\GRANULEcom{Substitution over a substitution}}\GRANULEprodnewline
\GRANULEprodline{|}{ \theta_{{\mathrm{1}}}  \uplus \ldots \uplus  \theta_{{\mathrm{2}}} }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{\theta  \GRANULEsym{,}  \theta'}{}{}{}{\GRANULEcom{Disjoint cat}}\GRANULEprodnewline
\GRANULEprodline{|}{ \theta   \setminus   \GRANULEmv{x} }{}{}{}{\GRANULEcom{Remove a substition for a
    variable}}}

\newcommand{\GRANULECostDict}{
\GRANULErulehead{\mathcal{C}}{::=}{}\GRANULEprodnewline
\GRANULEfirstprodline{|}{\GRANULEmv{x}  \mapsto  \GRANULEnt{c}}{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{\mathcal{C}  \GRANULEsym{+}  \mathcal{C}'}{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{\mathcal{C}  \GRANULEsym{,}  \mathcal{C}'}{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{\GRANULEsym{(}  \mathcal{C}  \GRANULEsym{)}}{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ \mathcal{C} }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ \emptyset }{}{}{}{}\GRANULEprodnewline
\GRANULEprodline{|}{ \textcolor{coeffectColor}{ \GRANULEnt{c} \textcolor{coeffectColor}{\,\cdot\,} } \mathcal{C} }{}{}{}{}}

\newcommand{\GRANULEgrammar}{\GRANULEgrammartabular{
\GRANULEFoc\GRANULEinterrule
\GRANULEt\GRANULEinterrule
\GRANULECon\GRANULEinterrule
\GRANULECases\GRANULEinterrule
\GRANULEp\GRANULEinterrule
\GRANULEIx\GRANULEinterrule
\GRANULEEqn\GRANULEinterrule
\GRANULEDef\GRANULEinterrule
\GRANULEA\GRANULEinterrule
\GRANULEop\GRANULEinterrule
\GRANULER\GRANULEinterrule
\GRANULEConstraints\GRANULEinterrule
\GRANULEc\GRANULEinterrule
\GRANULERel\GRANULEinterrule
\GRANULEk\GRANULEinterrule
\GRANULEDefines\GRANULEinterrule
\GRANULEAss\GRANULEinterrule
\GRANULEG\GRANULEinterrule
\GRANULECoeffInfo\GRANULEinterrule
\GRANULEP\GRANULEinterrule
\GRANULEComp\GRANULEinterrule
\GRANULETh\GRANULEinterrule
\GRANULECostDict\GRANULEafterlastrule
}}

% defnss
% defns Judgements
%% defn checkMiniDecl
\newcommand{\GRANULEdruleTyVarName}[0]{\GRANULEdrulename{TyVar}}
\newcommand{\GRANULEdruleTyVar}[1]{\GRANULEdrule[#1]{%
}{
   \textcolor{coeffectColor}{  0    \textcolor{coeffectColor}{\,\cdot\,} }  \Gamma    \GRANULEsym{,}   \GRANULEmv{x}  :_{\textcolor{coeffectColor}{   1   } }   \GRANULEnt{A}   \vdash  \GRANULEmv{x}  :  \GRANULEnt{A} }{%
{\GRANULEdruleTyVarName}{}%
}}


\newcommand{\GRANULEdruleTyAbsName}[0]{\GRANULEdrulename{TyAbs}}
\newcommand{\GRANULEdruleTyAbs}[1]{\GRANULEdrule[#1]{%
\GRANULEpremise{ \Gamma  \GRANULEsym{,}   \GRANULEmv{x}  :_{\textcolor{coeffectColor}{  \GRANULEnt{r}  } }   \GRANULEnt{A}   \vdash  \GRANULEnt{t}  :  \GRANULEnt{B} }%
}{
 \Gamma  \vdash   \lambda  \GRANULEmv{x}  .  \GRANULEnt{t}   :   \GRANULEnt{A} ^ \GRANULEnt{r}  \rightarrow  \GRANULEnt{B}  }{%
{\GRANULEdruleTyAbsName}{}%
}}


\newcommand{\GRANULEdruleTyAppName}[0]{\GRANULEdrulename{TyApp}}
\newcommand{\GRANULEdruleTyApp}[1]{\GRANULEdrule[#1]{%
\GRANULEpremise{  \Gamma_{{\mathrm{1}}}  \vdash  \GRANULEnt{t_{{\mathrm{1}}}}  :   \GRANULEnt{A} ^ \GRANULEnt{r}  \rightarrow  \GRANULEnt{B}    \quad\;\;   \Gamma_{{\mathrm{2}}}  \vdash  \GRANULEnt{t_{{\mathrm{2}}}}  :  \GRANULEnt{A}  }%
}{
 \Gamma_{{\mathrm{1}}}  \GRANULEsym{+}   \textcolor{coeffectColor}{ \GRANULEnt{r}   \textcolor{coeffectColor}{\,\cdot\,} }  \Gamma_{{\mathrm{2}}}   \vdash  \GRANULEnt{t_{{\mathrm{1}}}} \, \GRANULEnt{t_{{\mathrm{2}}}}  :  \GRANULEnt{B} }{%
{\GRANULEdruleTyAppName}{}%
}}


\newcommand{\GRANULEdruleTyConName}[0]{\GRANULEdrulename{TyCon}}
\newcommand{\GRANULEdruleTyCon}[1]{\GRANULEdrule[#1]{%
\GRANULEpremise{ (  C  :  \GRANULEnt{B_{{\mathrm{1}}}} ^ \GRANULEnt{q_{{\mathrm{1}}}}  \rightarrow ... \rightarrow  \GRANULEnt{B_{\GRANULEmv{n}}} ^ \GRANULEnt{q_{\GRANULEmv{n}}}  \rightarrow     K  \,   \vec{ \GRANULEnt{A} }     ) \in  D }%
}{
  \textcolor{coeffectColor}{  0    \textcolor{coeffectColor}{\,\cdot\,} }  \Gamma   \vdash   C   :    \GRANULEnt{B_{{\mathrm{1}}}} ^{q_1}  \rightarrow \! ... \! \rightarrow   \GRANULEnt{B_{\GRANULEmv{n}}} ^{q_n}  \rightarrow     K  \,   \vec{ \GRANULEnt{A} }      }{%
{\GRANULEdruleTyConName}{}%
}}


\newcommand{\GRANULEdruleTyPrName}[0]{\GRANULEdrulename{TyPr}}
\newcommand{\GRANULEdruleTyPr}[1]{\GRANULEdrule[#1]{%
\GRANULEpremise{ \Gamma  \vdash  \GRANULEnt{t}  :  \GRANULEnt{A} }%
}{
  \textcolor{coeffectColor}{ \GRANULEnt{r}   \textcolor{coeffectColor}{\,\cdot\,} }  \Gamma   \vdash  \GRANULEsym{[}  \GRANULEnt{t}  \GRANULEsym{]}  :   \Box_{  \GRANULEnt{r}  }  \GRANULEnt{A}  }{%
{\GRANULEdruleTyPrName}{}%
}}


\newcommand{\GRANULEdruleTyApproxName}[0]{\GRANULEdrulename{TyApprox}}
\newcommand{\GRANULEdruleTyApprox}[1]{\GRANULEdrule[#1]{%
\GRANULEpremise{  \Gamma  \GRANULEsym{,}   \GRANULEmv{x}  :_{\textcolor{coeffectColor}{  \GRANULEnt{r}  } }   \GRANULEnt{A}   \GRANULEsym{,}  \Gamma'  \vdash  \GRANULEnt{t}  :  \GRANULEnt{B}   \quad\;\;   \GRANULEnt{r}  \, \textcolor{coeffectColor}{\sqsubseteq} \,  \GRANULEnt{s}  }%
}{
 \Gamma  \GRANULEsym{,}   \GRANULEmv{x}  :_{\textcolor{coeffectColor}{  \GRANULEnt{s}  } }   \GRANULEnt{A}   \GRANULEsym{,}  \Gamma'  \vdash  \GRANULEnt{t}  :  \GRANULEnt{B} }{%
{\GRANULEdruleTyApproxName}{}%
}}


\newcommand{\GRANULEdruleTyCaseName}[0]{\GRANULEdrulename{TyCase}}
\newcommand{\GRANULEdruleTyCase}[1]{\GRANULEdrule[#1]{%
\GRANULEpremise{    \Gamma  \vdash  \GRANULEnt{t}  :  \GRANULEnt{A}   \quad\;\;   \GRANULEnt{r}  \vdash \,  \GRANULEnt{p_{\GRANULEmv{i}}}  :  \GRANULEnt{A}  \, \rhd \,  \Delta_{\GRANULEmv{i}}     \quad\;\;   \Gamma'  \GRANULEsym{,}  \Delta_{\GRANULEmv{i}}  \vdash  \GRANULEnt{t_{\GRANULEmv{i}}}  :  \GRANULEnt{B}  }%
}{
   \textcolor{coeffectColor}{ \GRANULEnt{r}   \textcolor{coeffectColor}{\,\cdot\,} }  \Gamma    \GRANULEsym{+}  \Gamma'  \vdash   \textbf{case} \  \GRANULEnt{t}  \ \textbf{of} \   \GRANULEnt{p_{{\mathrm{1}}}}  \mapsto  \GRANULEnt{t_{{\mathrm{1}}}} ; ... ;  \GRANULEnt{p_{\GRANULEmv{n}}}  \mapsto  \GRANULEnt{t_{\GRANULEmv{n}}}    :  \GRANULEnt{B} }{%
{\GRANULEdruleTyCaseName}{}%
}}

\newcommand{\GRANULEdefncheckMiniDecl}[1]{\begin{GRANULEdefnblock}[#1]{$ \Gamma  \vdash  \GRANULEnt{t}  :  \GRANULEnt{A} $}{\GRANULEcom{\section{Typing}}}
\GRANULEusedrule{\GRANULEdruleTyVar{}}
\GRANULEusedrule{\GRANULEdruleTyAbs{}}
\GRANULEusedrule{\GRANULEdruleTyApp{}}
\GRANULEusedrule{\GRANULEdruleTyCon{}}
\GRANULEusedrule{\GRANULEdruleTyPr{}}
\GRANULEusedrule{\GRANULEdruleTyApprox{}}
\GRANULEusedrule{\GRANULEdruleTyCase{}}
\end{GRANULEdefnblock}}

%% defn patternTyping
\newcommand{\GRANULEdrulePatWildName}[0]{\GRANULEdrulename{PatWild}}
\newcommand{\GRANULEdrulePatWild}[1]{\GRANULEdrule[#1]{%
\GRANULEpremise{  0   \, \textcolor{coeffectColor}{\sqsubseteq} \,  \GRANULEnt{r} }%
}{
 \GRANULEnt{r}  \vdash \,   \_   :  \GRANULEnt{A}  \, \rhd \,   \emptyset  }{%
{\GRANULEdrulePatWildName}{}%
}}


\newcommand{\GRANULEdrulePatVarName}[0]{\GRANULEdrulename{PatVar}}
\newcommand{\GRANULEdrulePatVar}[1]{\GRANULEdrule[#1]{%
}{
 \GRANULEnt{r}  \vdash \,  \GRANULEnt{p}  :  \GRANULEnt{A}  \, \rhd \,   \GRANULEmv{x}  :_{\textcolor{coeffectColor}{  \GRANULEnt{r}  } }   \GRANULEnt{A}  }{%
{\GRANULEdrulePatVarName}{}%
}}


\newcommand{\GRANULEdrulePatBoxName}[0]{\GRANULEdrulename{PatBox}}
\newcommand{\GRANULEdrulePatBox}[1]{\GRANULEdrule[#1]{%
\GRANULEpremise{ \GRANULEnt{r}  \textcolor{coeffectColor}{\,\cdot\,}  \GRANULEnt{s}  \vdash \,  \GRANULEnt{p}  :  \GRANULEnt{A}  \, \rhd \,  \Gamma }%
}{
 \GRANULEnt{r}  \vdash \,  \GRANULEsym{[}  \GRANULEnt{p}  \GRANULEsym{]}  :   \Box_{  \GRANULEnt{s}  }  \GRANULEnt{A}   \, \rhd \,  \Gamma }{%
{\GRANULEdrulePatBoxName}{}%
}}


\newcommand{\GRANULEdrulePatConName}[0]{\GRANULEdrulename{PatCon}}
\newcommand{\GRANULEdrulePatCon}[1]{\GRANULEdrule[#1]{%
\GRANULEpremise{ (  C  :  \GRANULEnt{B_{{\mathrm{1}}}} ^ \GRANULEnt{q_{{\mathrm{1}}}}  \rightarrow ... \rightarrow  \GRANULEnt{B_{\GRANULEmv{n}}} ^ \GRANULEnt{q_{\GRANULEmv{n}}}  \rightarrow     K  \,   \vec{ \GRANULEnt{A} }     ) \in  D }%
\GRANULEpremise{  \GRANULEnt{q_{\GRANULEmv{i}}}  \textcolor{coeffectColor}{\,\cdot\,}  \GRANULEnt{r}  \vdash \,  \GRANULEnt{p_{\GRANULEmv{i}}}  :  \GRANULEnt{B_{\GRANULEmv{i}}}  \, \rhd \,  \Gamma_{\GRANULEmv{i}}   \quad\;\;    |    K  \,   \vec{ \GRANULEnt{A} }     | > 1 \Rightarrow 1 \sqsubseteq  \GRANULEnt{r}   }%
}{
 \GRANULEnt{r}  \vdash \,  C \, \GRANULEnt{p_{{\mathrm{1}}}} \, ... \, \GRANULEnt{p_{\GRANULEmv{n}}}  :    K  \,   \vec{ \GRANULEnt{A} }     \, \rhd \,   \overrightarrow{ \Gamma_{\GRANULEmv{i}} }  }{%
{\GRANULEdrulePatConName}{}%
}}

\newcommand{\GRANULEdefnpatternTyping}[1]{\begin{GRANULEdefnblock}[#1]{$ \GRANULEnt{c}  \vdash \,  \GRANULEnt{p}  :  \GRANULEnt{A}  \, \rhd \,  \Gamma $}{\GRANULEcom{Declarative pattern checking for Granule Mini (monomorphic)}}
\GRANULEusedrule{\GRANULEdrulePatWild{}}
\GRANULEusedrule{\GRANULEdrulePatVar{}}
\GRANULEusedrule{\GRANULEdrulePatBox{}}
\GRANULEusedrule{\GRANULEdrulePatCon{}}
\end{GRANULEdefnblock}}

%% defn synthesiseSub

\newcommand{\GRANULEdefnsynthesiseSub}[1]{\begin{GRANULEdefnblock}[#1]{$ \Gamma_{{\mathrm{1}}}  \vdash  \GRANULEnt{A}  \Rightarrow^{-}  \GRANULEnt{t} \ |\  \Gamma_{{\mathrm{2}}} $}{}
\end{GRANULEdefnblock}}

%% defn SynthesiseAdd
\newcommand{\GRANULEdruleVarName}[0]{\GRANULEdrulename{Var}}
\newcommand{\GRANULEdruleVar}[1]{\GRANULEdrule[#1]{%
}{
 \Gamma  \GRANULEsym{,}   \GRANULEmv{x}  :_{\textcolor{coeffectColor}{  \GRANULEnt{r}  } }   \GRANULEnt{A}   \vdash  \GRANULEnt{A}  \Rightarrow  \GRANULEmv{x}  \mid    \textcolor{coeffectColor}{  0    \textcolor{coeffectColor}{\,\cdot\,} }  \Gamma    \GRANULEsym{,}   \GRANULEmv{x}  :_{\textcolor{coeffectColor}{   1   } }   \GRANULEnt{A}  }{%
{\GRANULEdruleVarName}{}%
}}


\newcommand{\GRANULEdruleAbsName}[0]{\GRANULEdrulename{Abs}}
\newcommand{\GRANULEdruleAbs}[1]{\GRANULEdrule[#1]{%
\GRANULEpremise{  \Gamma  \GRANULEsym{,}   \GRANULEmv{x}  :_{\textcolor{coeffectColor}{  \GRANULEnt{q}  } }   \GRANULEnt{A}   \vdash  \GRANULEnt{B}  \Rightarrow  \GRANULEnt{t}  \mid  \Delta  \GRANULEsym{,}   \GRANULEmv{x}  :_{\textcolor{coeffectColor}{  \GRANULEnt{r}  } }   \GRANULEnt{A}    \quad\;\;   \GRANULEnt{r}  \, \textcolor{coeffectColor}{\sqsubseteq} \,  \GRANULEnt{q}  }%
}{
 \Gamma  \vdash    \GRANULEnt{A} ^ \GRANULEnt{q}  \rightarrow  \GRANULEnt{B}    \Rightarrow   \lambda  \GRANULEmv{x}  .  \GRANULEnt{t}   \mid  \Delta }{%
{\GRANULEdruleAbsName}{}%
}}


\newcommand{\GRANULEdruleAppName}[0]{\GRANULEdrulename{App}}
\newcommand{\GRANULEdruleApp}[1]{\GRANULEdrule[#1]{%
\GRANULEpremise{ \Gamma  \GRANULEsym{,}   \GRANULEmv{x_{{\mathrm{1}}}}  :_{\textcolor{coeffectColor}{  \GRANULEnt{r_{{\mathrm{1}}}}  } }    \GRANULEnt{A} ^ \GRANULEnt{q}  \rightarrow  \GRANULEnt{B}    \GRANULEsym{,}   \GRANULEmv{x_{{\mathrm{2}}}}  :_{\textcolor{coeffectColor}{  \GRANULEnt{r_{{\mathrm{1}}}}  } }   \GRANULEnt{B}   \vdash  \GRANULEnt{C}  \Rightarrow  \GRANULEnt{t_{{\mathrm{1}}}}  \mid  \Delta_{{\mathrm{1}}}  \GRANULEsym{,}   \GRANULEmv{x_{{\mathrm{1}}}}  :_{\textcolor{coeffectColor}{  \GRANULEnt{s_{{\mathrm{1}}}}  } }    \GRANULEnt{A} ^ \GRANULEnt{q}  \rightarrow  \GRANULEnt{B}    \GRANULEsym{,}   \GRANULEmv{x_{{\mathrm{2}}}}  :_{\textcolor{coeffectColor}{  \GRANULEnt{s_{{\mathrm{2}}}}  } }   \GRANULEnt{B}  }%
\GRANULEpremise{ \Gamma  \GRANULEsym{,}   \GRANULEmv{x_{{\mathrm{1}}}}  :_{\textcolor{coeffectColor}{  \GRANULEnt{r_{{\mathrm{1}}}}  } }    \GRANULEnt{A} ^ \GRANULEnt{q}  \rightarrow  \GRANULEnt{B}    \vdash  \GRANULEnt{A}  \Rightarrow  \GRANULEnt{t_{{\mathrm{2}}}}  \mid  \Delta_{{\mathrm{2}}}  \GRANULEsym{,}   \GRANULEmv{x_{{\mathrm{1}}}}  :_{\textcolor{coeffectColor}{  \GRANULEnt{s_{{\mathrm{3}}}}  } }    \GRANULEnt{A} ^ \GRANULEnt{q}  \rightarrow  \GRANULEnt{B}   }%
}{
 \Gamma  \GRANULEsym{,}   \GRANULEmv{x_{{\mathrm{1}}}}  :_{\textcolor{coeffectColor}{  \GRANULEnt{r_{{\mathrm{1}}}}  } }    \GRANULEnt{A} ^ \GRANULEnt{q}  \rightarrow  \GRANULEnt{B}    \vdash  \GRANULEnt{C}  \Rightarrow    [  \GRANULEsym{(}  \GRANULEmv{x_{{\mathrm{1}}}} \, \GRANULEnt{t_{{\mathrm{2}}}}  \GRANULEsym{)}  /  \GRANULEmv{x_{{\mathrm{2}}}}  ]  \GRANULEnt{t_{{\mathrm{1}}}}    \mid  \GRANULEsym{(}  \Delta_{{\mathrm{1}}}  \GRANULEsym{+}   \textcolor{coeffectColor}{ \GRANULEnt{s_{{\mathrm{2}}}}   \textcolor{coeffectColor}{\,\cdot\,} }    \textcolor{coeffectColor}{ \GRANULEnt{q}   \textcolor{coeffectColor}{\,\cdot\,} }  \Delta_{{\mathrm{2}}}     \GRANULEsym{)}  \GRANULEsym{,}   \GRANULEmv{x_{{\mathrm{1}}}}  :_{\textcolor{coeffectColor}{   \GRANULEnt{s_{{\mathrm{2}}}}  \GRANULEsym{+}   \GRANULEnt{s_{{\mathrm{1}}}}  \GRANULEsym{+}   \GRANULEsym{(}  \GRANULEnt{s_{{\mathrm{2}}}}  \textcolor{coeffectColor}{\,\cdot\,}   \GRANULEnt{q}  \textcolor{coeffectColor}{\,\cdot\,}  \GRANULEnt{s_{{\mathrm{3}}}}   \GRANULEsym{)}     } }    \GRANULEnt{A} ^ \GRANULEnt{q}  \multimap  \GRANULEnt{B}   }{%
{\GRANULEdruleAppName}{}%
}}


\newcommand{\GRANULEdruleBoxName}[0]{\GRANULEdrulename{Box}}
\newcommand{\GRANULEdruleBox}[1]{\GRANULEdrule[#1]{%
\GRANULEpremise{ \Gamma  \vdash  \GRANULEnt{A}  \Rightarrow  \GRANULEnt{t}  \mid  \Delta }%
}{
 \Gamma  \vdash    \Box_{  \GRANULEnt{r}  }  \GRANULEnt{A}    \Rightarrow  \GRANULEsym{[}  \GRANULEnt{t}  \GRANULEsym{]}  \mid   \textcolor{coeffectColor}{ \GRANULEnt{r}   \textcolor{coeffectColor}{\,\cdot\,} }  \Delta  }{%
{\GRANULEdruleBoxName}{}%
}}


\newcommand{\GRANULEdruleConName}[0]{\GRANULEdrulename{Con}}
\newcommand{\GRANULEdruleCon}[1]{\GRANULEdrule[#1]{%
\GRANULEpremise{ (  C  :  \GRANULEnt{B_{{\mathrm{1}}}} ^ \GRANULEnt{q_{{\mathrm{1}}}}  \rightarrow ... \rightarrow  \GRANULEnt{B_{\GRANULEmv{n}}} ^ \GRANULEnt{q_{\GRANULEmv{n}}}  \rightarrow     K  \,   \vec{ \GRANULEnt{A} }     ) \in  D }%
\GRANULEpremise{ \Gamma  \vdash  \GRANULEnt{B_{\GRANULEmv{i}}}  \Rightarrow  \GRANULEnt{t_{\GRANULEmv{i}}}  \mid  \Delta_{\GRANULEmv{i}} }%
}{
 \Gamma  \vdash   K  \,   \vec{ \GRANULEnt{A} }    \Rightarrow  C \, \GRANULEnt{t_{{\mathrm{1}}}} \, ... \, \GRANULEnt{t_{\GRANULEmv{n}}}  \mid    \textcolor{coeffectColor}{  0    \textcolor{coeffectColor}{\,\cdot\,} }  \Gamma    \GRANULEsym{+}   \GRANULEsym{(}   \textcolor{coeffectColor}{ \GRANULEnt{q_{{\mathrm{1}}}}   \textcolor{coeffectColor}{\,\cdot\,} }  \Delta_{{\mathrm{1}}}   \GRANULEsym{)}  \GRANULEsym{+} \, ... \, \GRANULEsym{+}  \GRANULEsym{(}   \textcolor{coeffectColor}{ \GRANULEnt{q_{\GRANULEmv{n}}}   \textcolor{coeffectColor}{\,\cdot\,} }  \Delta_{\GRANULEmv{n}}   \GRANULEsym{)}  }{%
{\GRANULEdruleConName}{}%
}}


\newcommand{\GRANULEdruleConAltName}[0]{\GRANULEdrulename{ConAlt}}
\newcommand{\GRANULEdruleConAlt}[1]{\GRANULEdrule[#1]{%
\GRANULEpremise{ (  C  :  \GRANULEnt{B_{{\mathrm{1}}}} ^ \GRANULEnt{r_{{\mathrm{1}}}}  \rightarrow ... \rightarrow  \GRANULEnt{B_{\GRANULEmv{n}}} ^ \GRANULEnt{r_{\GRANULEmv{n}}}  \rightarrow     K  \, \GRANULEnt{A}   ) \in  D }%
\GRANULEpremise{ \Gamma  \GRANULEsym{,}   \GRANULEmv{x}  :_{\textcolor{coeffectColor}{   1   } }    \GRANULEnt{B_{{\mathrm{1}}}} ^{q_1}  \rightarrow \! ... \! \rightarrow   \GRANULEnt{B_{\GRANULEmv{n}}} ^{q_n}  \rightarrow     K  \, \GRANULEnt{A}     \vdash  \GRANULEnt{A_{{\mathrm{1}}}}  \Rightarrow  \GRANULEnt{t}  \mid  \Delta  \GRANULEsym{,}   \GRANULEmv{x}  :_{\textcolor{coeffectColor}{   1   } }    \GRANULEnt{B_{{\mathrm{1}}}} ^{q_1}  \rightarrow \! ... \! \rightarrow   \GRANULEnt{B_{\GRANULEmv{n}}} ^{q_n}  \rightarrow     K  \, \GRANULEnt{A}    }%
}{
 \Gamma  \vdash  \GRANULEnt{A_{{\mathrm{1}}}}  \Rightarrow  \GRANULEnt{t}  \mid  \Delta }{%
{\GRANULEdruleConAltName}{}%
}}


\newcommand{\GRANULEdruleCaseName}[0]{\GRANULEdrulename{Case}}
\newcommand{\GRANULEdruleCase}[1]{\GRANULEdrule[#1]{%
\GRANULEpremise{ (  C_{\GRANULEmv{i}}  :  \GRANULEnt{B_{{\mathrm{1}}}} ^{q_1^i} \rightarrow ... \rightarrow  \GRANULEnt{B_{\GRANULEmv{n}}} ^{q_n^i} \rightarrow     K  \,   \vec{ \GRANULEnt{A} }     ) \in  D }%
\GRANULEpremise{    \Gamma  \GRANULEsym{,}   \GRANULEmv{x}  :_{\textcolor{coeffectColor}{   \GRANULEnt{r}   } }    K  \, \GRANULEnt{A}    \GRANULEsym{,}   {  \GRANULEmv{y} ^  i  _  1   }:_{\textcolor{coeffectColor}{     \GRANULEnt{q} ^  i  _  1      } }   \GRANULEnt{B_{{\mathrm{1}}}}    , ... ,   {  \GRANULEmv{y} ^  i  _  n   }:_{\textcolor{coeffectColor}{     \GRANULEnt{q} ^  i  _  n      } }   \GRANULEnt{B_{\GRANULEmv{n}}}    \vdash  \GRANULEnt{B}  \Rightarrow  \GRANULEnt{t_{\GRANULEmv{i}}}  \mid     \Delta_{\GRANULEmv{i}}  \GRANULEsym{,}   \GRANULEmv{x}  :_{\textcolor{coeffectColor}{   \GRANULEnt{r_{\GRANULEmv{i}}}   } }    K  \, \GRANULEnt{A}    \GRANULEsym{,}   {  \GRANULEmv{y} ^  i  _  1   }:_{\textcolor{coeffectColor}{    \GRANULEnt{s} ^  i  _  1     } }   \GRANULEnt{B_{{\mathrm{1}}}}    , ... ,   {  \GRANULEmv{y} ^  i  _  n   }:_{\textcolor{coeffectColor}{    \GRANULEnt{s} ^  i  _  n     } }   \GRANULEnt{B_{\GRANULEmv{n}}}   }%
\GRANULEpremise{   \GRANULEnt{s} ^  i  _  j     \, \textcolor{coeffectColor}{\sqsubseteq} \,    \GRANULEnt{q} ^  i  _  j    }%
\GRANULEpremise{   \GRANULEnt{s} _  i     =      \GRANULEnt{s} ^  i  _  1     \sqcup ... \sqcup    \GRANULEnt{s} ^  i  _  n      }%
}{
 \Gamma  \GRANULEsym{,}   \GRANULEmv{x}  :_{\textcolor{coeffectColor}{  \GRANULEnt{r}  } }     K  \, \GRANULEnt{A}    \vdash  \GRANULEnt{B}  \Rightarrow   \textbf{case} \  \GRANULEmv{x}  \ \textbf{of} \   \overline{   C_{\GRANULEmv{i}}  \  \GRANULEmv{y} ^  i  _  1   ...  \GRANULEmv{y} ^  i  _  n    \mapsto  \GRANULEnt{t_{\GRANULEmv{i}}} }    \mid  \GRANULEsym{(}   \Delta_{{\mathrm{1}}}  \sqcup ...  \sqcup  \Delta_{\GRANULEmv{n}}   \GRANULEsym{)}  \GRANULEsym{,}    \GRANULEmv{x}  :_{\textcolor{coeffectColor}{   \GRANULEsym{(}     \GRANULEnt{r} _  1     \sqcup ... \sqcup    \GRANULEnt{r} _  n      \GRANULEsym{)}   \GRANULEsym{+}   \GRANULEsym{(}     \GRANULEnt{s} _  1     \sqcup ... \sqcup    \GRANULEnt{s} _  n      \GRANULEsym{)}   } }     K  \, \GRANULEnt{A}    }{%
{\GRANULEdruleCaseName}{}%
}}


\newcommand{\GRANULEdruleCaseAltName}[0]{\GRANULEdrulename{CaseAlt}}
\newcommand{\GRANULEdruleCaseAlt}[1]{\GRANULEdrule[#1]{%
\GRANULEpremise{ (  C_{\GRANULEmv{i}}  :  \GRANULEnt{B_{{\mathrm{1}}}} ^{q_1^i} \rightarrow ... \rightarrow  \GRANULEnt{B_{\GRANULEmv{n}}} ^{q_n^i} \rightarrow     K  \,   \vec{ \GRANULEnt{A} }     ) \in  D }%
\GRANULEpremise{    \Gamma  \GRANULEsym{,}   \GRANULEmv{x}  :_{\textcolor{coeffectColor}{   \GRANULEnt{r}   } }    K  \,   \vec{ \GRANULEnt{A} }      \GRANULEsym{,}   {  \GRANULEmv{y} ^  i  _  1   }:_{\textcolor{coeffectColor}{   \GRANULEnt{r}  \textcolor{coeffectColor}{\,\cdot\,}    \GRANULEnt{q} ^  i  _  1      } }   \GRANULEnt{B_{{\mathrm{1}}}}    , ... ,   {  \GRANULEmv{y} ^  i  _  n   }:_{\textcolor{coeffectColor}{   \GRANULEnt{r}  \textcolor{coeffectColor}{\,\cdot\,}    \GRANULEnt{q} ^  i  _  1      } }   \GRANULEnt{B_{\GRANULEmv{n}}}    \vdash  \GRANULEnt{B}  \Rightarrow  \GRANULEnt{t_{\GRANULEmv{i}}}  \mid     \Delta_{\GRANULEmv{i}}  \GRANULEsym{,}   \GRANULEmv{x}  :_{\textcolor{coeffectColor}{   \GRANULEnt{r_{\GRANULEmv{i}}}   } }    K  \,   \vec{ \GRANULEnt{A} }      \GRANULEsym{,}   {  \GRANULEmv{y} ^  i  _  1   }:_{\textcolor{coeffectColor}{    \GRANULEnt{s} ^  i  _  1     } }   \GRANULEnt{B_{{\mathrm{1}}}}    , ... ,   {  \GRANULEmv{y} ^  i  _  n   }:_{\textcolor{coeffectColor}{    \GRANULEnt{s} ^  i  _  n     } }   \GRANULEnt{B_{\GRANULEmv{n}}}   }%
\GRANULEpremise{ \exists    \GRANULEnt{s'} ^  i  _  j     .\,     \GRANULEnt{s} ^  i  _  j     \sqsubseteq    \GRANULEnt{s'} ^  i  _  j     \textcolor{coeffectColor}{\,\cdot\,}    \GRANULEnt{q} ^  i  _  j     \sqsubseteq  \GRANULEnt{r}  \textcolor{coeffectColor}{\,\cdot\,}    \GRANULEnt{q} ^  i  _  j     }%
\GRANULEpremise{   \GRANULEnt{s} _  i     =      \GRANULEnt{s'} ^  i  _  1     \sqcup ... \sqcup    \GRANULEnt{s'} ^  i  _  n      }%
\GRANULEpremise{  |    K  \,   \vec{ \GRANULEnt{A} }     | > 1 \Rightarrow 1 \sqsubseteq      \GRANULEnt{s} _  1     \sqcup ... \sqcup    \GRANULEnt{s} _  m       }%
}{
 \Gamma  \GRANULEsym{,}   \GRANULEmv{x}  :_{\textcolor{coeffectColor}{  \GRANULEnt{r}  } }     K  \,   \vec{ \GRANULEnt{A} }      \vdash  \GRANULEnt{B}  \Rightarrow   \textbf{case} \  \GRANULEmv{x}  \ \textbf{of} \   \overline{   C_{\GRANULEmv{i}}  \  \GRANULEmv{y} ^  i  _  1   ...  \GRANULEmv{y} ^  i  _  n    \mapsto  \GRANULEnt{t_{\GRANULEmv{i}}} }    \mid  \GRANULEsym{(}   \Delta_{{\mathrm{1}}}  \sqcup ...  \sqcup  \Delta_{\GRANULEmv{m}}   \GRANULEsym{)}  \GRANULEsym{,}    \GRANULEmv{x}  :_{\textcolor{coeffectColor}{   \GRANULEsym{(}     \GRANULEnt{r} _  1     \sqcup ... \sqcup    \GRANULEnt{r} _  m      \GRANULEsym{)}   \GRANULEsym{+}   \GRANULEsym{(}     \GRANULEnt{s} _  1     \sqcup ... \sqcup    \GRANULEnt{s} _  m      \GRANULEsym{)}   } }     K  \,   \vec{ \GRANULEnt{A} }      }{%
{\GRANULEdruleCaseAltName}{}%
}}


\newcommand{\GRANULEdruleCaseAltAltName}[0]{\GRANULEdrulename{CaseAltAlt}}
\newcommand{\GRANULEdruleCaseAltAlt}[1]{\GRANULEdrule[#1]{%
\GRANULEpremise{ (  C_{\GRANULEmv{i}}  :  \GRANULEnt{B_{{\mathrm{1}}}} ^{q_1^i} \rightarrow ... \rightarrow  \GRANULEnt{B_{\GRANULEmv{n}}} ^{q_n^i} \rightarrow     K  \, \GRANULEnt{A}   ) \in  D }%
\GRANULEpremise{    \Gamma  \GRANULEsym{,}   \GRANULEmv{x}  :_{\textcolor{coeffectColor}{   \GRANULEnt{r}   } }    K  \, \GRANULEnt{A}    \GRANULEsym{,}   {  \GRANULEmv{y} ^  i  _  1   }:_{\textcolor{coeffectColor}{   \GRANULEnt{r}  \textcolor{coeffectColor}{\,\cdot\,}    \GRANULEnt{q} ^  i  _  1      } }   \GRANULEnt{B_{{\mathrm{1}}}}    , ... ,   {  \GRANULEmv{y} ^  i  _  n   }:_{\textcolor{coeffectColor}{   \GRANULEnt{r}  \textcolor{coeffectColor}{\,\cdot\,}    \GRANULEnt{q} ^  i  _  1      } }   \GRANULEnt{B_{\GRANULEmv{n}}}    \vdash  \GRANULEnt{B}  \Rightarrow  \GRANULEnt{t_{\GRANULEmv{i}}}  \mid     \Delta_{\GRANULEmv{i}}  \GRANULEsym{,}   \GRANULEmv{x}  :_{\textcolor{coeffectColor}{   \GRANULEnt{r_{\GRANULEmv{i}}}   } }    K  \, \GRANULEnt{A}    \GRANULEsym{,}   {  \GRANULEmv{y} ^  i  _  1   }:_{\textcolor{coeffectColor}{    \GRANULEnt{s} ^  i  _  1     } }   \GRANULEnt{B_{{\mathrm{1}}}}    , ... ,   {  \GRANULEmv{y} ^  i  _  n   }:_{\textcolor{coeffectColor}{    \GRANULEnt{s} ^  i  _  n     } }   \GRANULEnt{B_{\GRANULEmv{n}}}   }%
\GRANULEpremise{   \GRANULEnt{s} _  i     =      \GRANULEnt{s} ^  i  _  1     \sqcup ... \sqcup    \GRANULEnt{s} ^  i  _  n      }%
\GRANULEpremise{   \GRANULEnt{q} _  i     =      \GRANULEnt{q} ^  i  _  1     \sqcup ... \sqcup    \GRANULEnt{q} ^  i  _  n      }%
\GRANULEpremise{ \exists    \GRANULEnt{s'} _  i     .\,     \GRANULEnt{s} _  i     \sqsubseteq    \GRANULEnt{s'} _  i     \textcolor{coeffectColor}{\,\cdot\,}    \GRANULEnt{q} _  i     \sqsubseteq  \GRANULEnt{r}  \textcolor{coeffectColor}{\,\cdot\,}    \GRANULEnt{q} _  i     }%
}{
 \Gamma  \GRANULEsym{,}   \GRANULEmv{x}  :_{\textcolor{coeffectColor}{  \GRANULEnt{r}  } }     K  \, \GRANULEnt{A}    \vdash  \GRANULEnt{B}  \Rightarrow   \textbf{case} \  \GRANULEmv{x}  \ \textbf{of} \   \overline{   C_{\GRANULEmv{i}}  \  \GRANULEmv{y} ^  i  _  1   ...  \GRANULEmv{y} ^  i  _  n    \mapsto  \GRANULEnt{t_{\GRANULEmv{i}}} }    \mid  \GRANULEsym{(}   \Delta_{{\mathrm{1}}}  \sqcup ...  \sqcup  \Delta_{\GRANULEmv{n}}   \GRANULEsym{)}  \GRANULEsym{,}    \GRANULEmv{x}  :_{\textcolor{coeffectColor}{   \GRANULEsym{(}     \GRANULEnt{r} _  1     \sqcup ... \sqcup    \GRANULEnt{r} _  n      \GRANULEsym{)}   \GRANULEsym{+}   \GRANULEsym{(}     \GRANULEnt{s'} _  1     \sqcup ... \sqcup    \GRANULEnt{s'} _  n      \GRANULEsym{)}   } }     K  \, \GRANULEnt{A}    }{%
{\GRANULEdruleCaseAltAltName}{}%
}}


\newcommand{\GRANULEdruleUnboxName}[0]{\GRANULEdrulename{Unbox}}
\newcommand{\GRANULEdruleUnbox}[1]{\GRANULEdrule[#1]{%
\GRANULEpremise{ \Gamma  \GRANULEsym{,}   \GRANULEmv{y}  :_{\textcolor{coeffectColor}{   \GRANULEnt{r}  \textcolor{coeffectColor}{\,\cdot\,}  \GRANULEnt{q}   } }   \GRANULEnt{A}   \GRANULEsym{,}   \GRANULEmv{x}  :_{\textcolor{coeffectColor}{  \GRANULEnt{r}  } }    \Box_{  \GRANULEnt{q}  }  \GRANULEnt{A}    \vdash  \GRANULEnt{B}  \Rightarrow  \GRANULEnt{t}  \mid  \Delta  \GRANULEsym{,}   \GRANULEmv{y}  :_{\textcolor{coeffectColor}{   \GRANULEnt{s_{{\mathrm{1}}}}   } }   \GRANULEnt{A}   \GRANULEsym{,}   \GRANULEmv{x}  :_{\textcolor{coeffectColor}{  \GRANULEnt{s_{{\mathrm{2}}}}  } }    \Box_{  \GRANULEnt{q}  }  \GRANULEnt{A}   }%
\GRANULEpremise{ \exists  \GRANULEnt{s_{{\mathrm{3}}}}  .\,   \GRANULEnt{s_{{\mathrm{1}}}}  \sqsubseteq   \GRANULEnt{s_{{\mathrm{3}}}}  \textcolor{coeffectColor}{\,\cdot\,}  \GRANULEnt{q}   \sqsubseteq   \GRANULEnt{r}  \textcolor{coeffectColor}{\,\cdot\,}  \GRANULEnt{q}   }%
}{
 \Gamma  \GRANULEsym{,}   \GRANULEmv{x}  :_{\textcolor{coeffectColor}{  \GRANULEnt{r}  } }    \Box_{  \GRANULEnt{q}  }  \GRANULEnt{A}    \vdash  \GRANULEnt{B}  \Rightarrow   \textbf{case} \  \GRANULEmv{x}  \ \textbf{of} \  \GRANULEsym{[}  \GRANULEmv{y}  \GRANULEsym{]}  \rightarrow  \GRANULEnt{t}   \mid   \Delta   \GRANULEsym{,}   \GRANULEmv{x}  :_{\textcolor{coeffectColor}{   \GRANULEnt{s_{{\mathrm{3}}}}  \GRANULEsym{+}  \GRANULEnt{s_{{\mathrm{2}}}}   } }    \Box_{  \GRANULEnt{q}  }  \GRANULEnt{A}   }{%
{\GRANULEdruleUnboxName}{}%
}}


\newcommand{\GRANULEdruleCaseSubName}[0]{\GRANULEdrulename{CaseSub}}
\newcommand{\GRANULEdruleCaseSub}[1]{\GRANULEdrule[#1]{%
\GRANULEpremise{ (  C_{\GRANULEmv{i}}  :  \GRANULEnt{B_{{\mathrm{1}}}} ^ \GRANULEnt{q_{{\mathrm{1}}}}  \rightarrow ... \rightarrow  \GRANULEnt{B_{\GRANULEmv{n}}} ^ \GRANULEnt{q_{\GRANULEmv{n}}}  \rightarrow     K  \, \GRANULEnt{A}   ) \in  D }%
\GRANULEpremise{    \Gamma  \GRANULEsym{,}   \GRANULEmv{x}  :_{\textcolor{coeffectColor}{   \GRANULEnt{r}   } }     K  \, \GRANULEnt{A}     \GRANULEsym{,}   {  \GRANULEmv{y} ^  i  _  1   }:_{\textcolor{coeffectColor}{   \GRANULEnt{r}  \textcolor{coeffectColor}{\,\cdot\,}  \GRANULEnt{q_{{\mathrm{1}}}}   } }   \GRANULEnt{B_{{\mathrm{1}}}}    , ... ,   {  \GRANULEmv{y} ^  i  _  n   }:_{\textcolor{coeffectColor}{   \GRANULEnt{r}  \textcolor{coeffectColor}{\,\cdot\,}  \GRANULEnt{q_{\GRANULEmv{n}}}   } }   \GRANULEnt{B_{\GRANULEmv{n}}}    \vdash  \GRANULEnt{B}  \Rightarrow  \GRANULEnt{t_{\GRANULEmv{i}}}  \mid     \Delta_{\GRANULEmv{i}}  \GRANULEsym{,}   \GRANULEmv{x}  :_{\textcolor{coeffectColor}{    \GRANULEnt{r} ^  i  _  1     } }    K  \, \GRANULEnt{A}    \GRANULEsym{,}   {  \GRANULEmv{y} ^  i  _  1   }:_{\textcolor{coeffectColor}{    \GRANULEnt{s} ^  i  _  1     } }   \GRANULEnt{B_{{\mathrm{1}}}}    , ... ,   {  \GRANULEmv{y} ^  i  _  n   }:_{\textcolor{coeffectColor}{    \GRANULEnt{s} ^  i  _  n     } }   \GRANULEnt{B_{\GRANULEmv{n}}}   }%
\GRANULEpremise{ \exists    \GRANULEnt{r} ^  i  _  2     .\,   \GRANULEnt{r}  \sqsupseteq    \GRANULEnt{r} ^  i  _  2     \GRANULEsym{+}     \GRANULEnt{r} ^  i  _  1     \textcolor{coeffectColor}{\,\cdot\,}  \GRANULEsym{(}     \GRANULEnt{s} ^  i  _  1     \sqcap ... \sqcap    \GRANULEnt{s} ^  n  _  1      \GRANULEsym{)}   }%
}{
 \Gamma  \GRANULEsym{,}   \GRANULEmv{x}  :_{\textcolor{coeffectColor}{  \GRANULEnt{r_{{\mathrm{1}}}}  } }     K  \, \GRANULEnt{A}    \vdash  \GRANULEnt{B}  \Rightarrow   \textbf{case} \  \GRANULEmv{x}  \ \textbf{of} \   \overline{   C_{\GRANULEmv{i}}  \  \GRANULEmv{y} ^  i  _  1   ...  \GRANULEmv{y} ^  i  _  n    \mapsto  \GRANULEnt{t_{\GRANULEmv{i}}} }    \mid  \GRANULEsym{(}   \Delta_{{\mathrm{1}}}  \sqcap ... \sqcap  \Delta_{\GRANULEmv{n}}   \GRANULEsym{)}  \GRANULEsym{,}   \GRANULEmv{x}  :_{\textcolor{coeffectColor}{      \GRANULEnt{r} ^  1  _  2     \sqcap ... \sqcap    \GRANULEnt{r} ^  n  _  2       } }     K  \, \GRANULEnt{A}   }{%
{\GRANULEdruleCaseSubName}{}%
}}

\newcommand{\GRANULEdefnSynthesiseAdd}[1]{\begin{GRANULEdefnblock}[#1]{$ \Gamma  \vdash  \GRANULEnt{A}  \Rightarrow  \GRANULEnt{t}  \mid  \Delta $}{}
\GRANULEusedrule{\GRANULEdruleVar{}}
\GRANULEusedrule{\GRANULEdruleAbs{}}
\GRANULEusedrule{\GRANULEdruleApp{}}
\GRANULEusedrule{\GRANULEdruleBox{}}
\GRANULEusedrule{\GRANULEdruleCon{}}
\GRANULEusedrule{\GRANULEdruleConAlt{}}
\GRANULEusedrule{\GRANULEdruleCase{}}
\GRANULEusedrule{\GRANULEdruleCaseAlt{}}
\GRANULEusedrule{\GRANULEdruleCaseAltAlt{}}
\GRANULEusedrule{\GRANULEdruleUnbox{}}
\GRANULEusedrule{\GRANULEdruleCaseSub{}}
\end{GRANULEdefnblock}}

%% defn RASynFocus
\newcommand{\GRANULEdruleAbsFName}[0]{\GRANULEdrulename{AbsF}}
\newcommand{\GRANULEdruleAbsF}[1]{\GRANULEdrule[#1]{%
\GRANULEpremise{  \Gamma  ; \Omega \vdash  \GRANULEnt{B}  \Uparrow \Rightarrow  \GRANULEnt{t}  \mid  \Delta  \GRANULEsym{,}   \GRANULEmv{x}  :_{\textcolor{coeffectColor}{  \GRANULEnt{r}  } }   \GRANULEnt{A}    \quad\;\;   \GRANULEnt{r}  \, \textcolor{coeffectColor}{\sqsubseteq} \,  \GRANULEnt{q}  }%
}{
 \Gamma  ; \Omega \vdash    \GRANULEnt{A} ^ \GRANULEnt{q}  \rightarrow  \GRANULEnt{B}    \Uparrow \Rightarrow   \lambda  \GRANULEmv{x}  .  \GRANULEnt{t}   \mid  \Delta }{%
{\GRANULEdruleAbsFName}{}%
}}

\newcommand{\GRANULEdefnRASynFocus}[1]{\begin{GRANULEdefnblock}[#1]{$ \Gamma  ; \Omega \vdash  \GRANULEnt{A}  \Uparrow \Rightarrow  \GRANULEnt{t}  \mid  \Delta $}{}
\GRANULEusedrule{\GRANULEdruleAbsF{}}
\end{GRANULEdefnblock}}

%% defn LASynFocus
\newcommand{\GRANULEdruleCaseFName}[0]{\GRANULEdrulename{CaseF}}
\newcommand{\GRANULEdruleCaseF}[1]{\GRANULEdrule[#1]{%
\GRANULEpremise{ (  C_{\GRANULEmv{i}}  :  \GRANULEnt{B_{{\mathrm{1}}}} ^ \GRANULEnt{q_{{\mathrm{1}}}}  \rightarrow ... \rightarrow  \GRANULEnt{B_{\GRANULEmv{n}}} ^ \GRANULEnt{q_{\GRANULEmv{n}}}  \rightarrow     K  \, \GRANULEnt{A}   ) \in  D }%
\GRANULEpremise{ \Gamma  ;      \Omega  \GRANULEsym{,}   \GRANULEmv{x}  :_{\textcolor{coeffectColor}{   \GRANULEnt{r}   } }    K  \, \GRANULEnt{A_{{\mathrm{1}}}}    \GRANULEsym{,}   {  \GRANULEmv{y} ^  i  _  1   }:_{\textcolor{coeffectColor}{   \GRANULEnt{q_{{\mathrm{1}}}}   } }   \GRANULEnt{B_{{\mathrm{1}}}}    , ... ,   {  \GRANULEmv{y} ^  i  _  n   }:_{\textcolor{coeffectColor}{   \GRANULEnt{q_{\GRANULEmv{n}}}   } }   \GRANULEnt{B_{\GRANULEmv{n}}}     \Uparrow \vdash  \GRANULEnt{B}  \Rightarrow  \GRANULEnt{t_{\GRANULEmv{i}}}  \mid     \Delta_{\GRANULEmv{i}}  \GRANULEsym{,}   \GRANULEmv{x}  :_{\textcolor{coeffectColor}{   \GRANULEnt{r_{\GRANULEmv{i}}}   } }    K  \, \GRANULEnt{A}    \GRANULEsym{,}   {  \GRANULEmv{y} ^  i  _  1   }:_{\textcolor{coeffectColor}{    \GRANULEnt{s} ^  i  _  1     } }   \GRANULEnt{B_{{\mathrm{1}}}}    , ... ,   {  \GRANULEmv{y} ^  i  _  n   }:_{\textcolor{coeffectColor}{    \GRANULEnt{s} ^  i  _  n     } }   \GRANULEnt{B_{\GRANULEmv{n}}}   }%
\GRANULEpremise{   \GRANULEnt{s} ^  i  _  j     \, \textcolor{coeffectColor}{\sqsubseteq} \,  \GRANULEnt{q_{\GRANULEmv{j}}} }%
\GRANULEpremise{   \GRANULEnt{s} _  i     =      \GRANULEnt{s} ^  i  _  1     \sqcup ... \sqcup    \GRANULEnt{s} ^  i  _  n      }%
}{
 \Gamma  ;   \Omega  \GRANULEsym{,}   \GRANULEmv{x}  :_{\textcolor{coeffectColor}{  \GRANULEnt{r}  } }     K  \, \GRANULEnt{A}     \Uparrow \vdash  \GRANULEnt{B}  \Rightarrow   \textbf{case} \  \GRANULEmv{x}  \ \textbf{of} \   \overline{   C_{\GRANULEmv{i}}  \  \GRANULEmv{y} ^  i  _  1   ...  \GRANULEmv{y} ^  i  _  n    \mapsto  \GRANULEnt{t_{\GRANULEmv{i}}} }    \mid  \GRANULEsym{(}   \Delta_{{\mathrm{1}}}  \sqcup ...  \sqcup  \Delta_{\GRANULEmv{n}}   \GRANULEsym{)}  \GRANULEsym{,}    \GRANULEmv{x}  :_{\textcolor{coeffectColor}{   \GRANULEsym{(}     \GRANULEnt{r} _  1     \sqcup ... \sqcup    \GRANULEnt{r} _  n      \GRANULEsym{)}   \GRANULEsym{+}   \GRANULEsym{(}     \GRANULEnt{s} _  1     \sqcup ... \sqcup    \GRANULEnt{s} _  n      \GRANULEsym{)}   } }     K  \, \GRANULEnt{A}    }{%
{\GRANULEdruleCaseFName}{}%
}}


\newcommand{\GRANULEdruleUnboxFName}[0]{\GRANULEdrulename{UnboxF}}
\newcommand{\GRANULEdruleUnboxF}[1]{\GRANULEdrule[#1]{%
\GRANULEpremise{ \Gamma  ;   \Omega  \GRANULEsym{,}   \GRANULEmv{y}  :_{\textcolor{coeffectColor}{   \GRANULEnt{r}  \textcolor{coeffectColor}{\,\cdot\,}  \GRANULEnt{q}   } }   \GRANULEnt{A}   \GRANULEsym{,}   \GRANULEmv{x}  :_{\textcolor{coeffectColor}{  \GRANULEnt{r}  } }    \Box_{  \GRANULEnt{q}  }  \GRANULEnt{A}     \Uparrow \vdash  \GRANULEnt{B}  \Rightarrow  \GRANULEnt{t}  \mid  \Delta  \GRANULEsym{,}   \GRANULEmv{y}  :_{\textcolor{coeffectColor}{   \GRANULEnt{s_{{\mathrm{1}}}}   } }   \GRANULEnt{A}   \GRANULEsym{,}   \GRANULEmv{x}  :_{\textcolor{coeffectColor}{  \GRANULEnt{s_{{\mathrm{2}}}}  } }    \Box_{  \GRANULEnt{q}  }  \GRANULEnt{A}   }%
\GRANULEpremise{ \exists  \GRANULEnt{s_{{\mathrm{3}}}}  .\,   \GRANULEnt{s_{{\mathrm{3}}}}  \textcolor{coeffectColor}{\,\cdot\,}  \GRANULEnt{q}  \sqsubseteq  \GRANULEnt{s_{{\mathrm{1}}}}  }%
}{
 \Gamma  ;   \Omega  \GRANULEsym{,}   \GRANULEmv{x}  :_{\textcolor{coeffectColor}{  \GRANULEnt{r}  } }    \Box_{  \GRANULEnt{q}  }  \GRANULEnt{A}     \Uparrow \vdash  \GRANULEnt{B}  \Rightarrow   \textbf{case} \  \GRANULEmv{x}  \ \textbf{of} \  \GRANULEsym{[}  \GRANULEmv{y}  \GRANULEsym{]}  \rightarrow  \GRANULEnt{t}   \mid   \Delta   \GRANULEsym{,}   \GRANULEmv{x}  :_{\textcolor{coeffectColor}{   \GRANULEnt{s_{{\mathrm{3}}}}  \GRANULEsym{+}  \GRANULEnt{s_{{\mathrm{2}}}}   } }    \Box_{  \GRANULEnt{q}  }  \GRANULEnt{A}   }{%
{\GRANULEdruleUnboxFName}{}%
}}

\newcommand{\GRANULEdefnLASynFocus}[1]{\begin{GRANULEdefnblock}[#1]{$ \Gamma  ;  \Omega  \Uparrow \vdash  \GRANULEnt{A}  \Rightarrow  \GRANULEnt{t}  \mid  \Delta $}{}
\GRANULEusedrule{\GRANULEdruleCaseF{}}
\GRANULEusedrule{\GRANULEdruleUnboxF{}}
\end{GRANULEdefnblock}}

%% defn RSSynFocus
\newcommand{\GRANULEdruleBoxFName}[0]{\GRANULEdrulename{BoxF}}
\newcommand{\GRANULEdruleBoxF}[1]{\GRANULEdrule[#1]{%
\GRANULEpremise{ \Gamma  \vdash  \GRANULEnt{A}  \Downarrow  \GRANULEnt{t}  \mid  \Delta }%
}{
 \Gamma  \vdash    \Box_{  \GRANULEnt{r}  }  \GRANULEnt{A}    \Downarrow  \GRANULEsym{[}  \GRANULEnt{t}  \GRANULEsym{]}  \mid   \textcolor{coeffectColor}{ \GRANULEnt{r}   \textcolor{coeffectColor}{\,\cdot\,} }  \Delta  }{%
{\GRANULEdruleBoxFName}{}%
}}


\newcommand{\GRANULEdruleConFName}[0]{\GRANULEdrulename{ConF}}
\newcommand{\GRANULEdruleConF}[1]{\GRANULEdrule[#1]{%
\GRANULEpremise{ (  C  :  \GRANULEnt{B_{{\mathrm{1}}}} ^1 \rightarrow ... \rightarrow  \GRANULEnt{B_{\GRANULEmv{n}}} ^1 \rightarrow     K  \, \GRANULEnt{A}   ) \in  D }%
\GRANULEpremise{ \Gamma  \vdash  \GRANULEnt{B_{\GRANULEmv{i}}}  \Downarrow  \GRANULEnt{t_{\GRANULEmv{i}}}  \mid  \Delta_{\GRANULEmv{i}} }%
}{
 \Gamma  \vdash    K  \, \GRANULEnt{A}   \Downarrow  C \, \GRANULEnt{t_{{\mathrm{1}}}} \, ... \, \GRANULEnt{t_{\GRANULEmv{n}}}  \mid   \Delta_{{\mathrm{1}}}  \GRANULEsym{+} \, ... \, \GRANULEsym{+}  \Delta_{\GRANULEmv{n}}  }{%
{\GRANULEdruleConFName}{}%
}}

\newcommand{\GRANULEdefnRSSynFocus}[1]{\begin{GRANULEdefnblock}[#1]{$ \Gamma  \vdash  \GRANULEnt{A}  \Downarrow  \GRANULEnt{t}  \mid  \Delta $}{}
\GRANULEusedrule{\GRANULEdruleBoxF{}}
\GRANULEusedrule{\GRANULEdruleConF{}}
\end{GRANULEdefnblock}}

%% defn LSSynFocus
\newcommand{\GRANULEdruleVarFName}[0]{\GRANULEdrulename{VarF}}
\newcommand{\GRANULEdruleVarF}[1]{\GRANULEdrule[#1]{%
}{
 \Gamma  ;   \GRANULEmv{x}  :_{\textcolor{coeffectColor}{  \GRANULEnt{r}  } }   \GRANULEnt{A}   \Downarrow \vdash  \GRANULEnt{A}  \Rightarrow  \GRANULEmv{x}  \mid    \textcolor{coeffectColor}{  0    \textcolor{coeffectColor}{\,\cdot\,} }  \Gamma    \GRANULEsym{,}   \GRANULEmv{x}  :_{\textcolor{coeffectColor}{   1   } }   \GRANULEnt{A}  }{%
{\GRANULEdruleVarFName}{}%
}}


\newcommand{\GRANULEdruleAppFName}[0]{\GRANULEdrulename{AppF}}
\newcommand{\GRANULEdruleAppF}[1]{\GRANULEdrule[#1]{%
\GRANULEpremise{ \Gamma  ;    \GRANULEmv{x_{{\mathrm{1}}}}  :_{\textcolor{coeffectColor}{  \GRANULEnt{r_{{\mathrm{1}}}}  } }    \GRANULEnt{A} ^ \GRANULEnt{q}  \rightarrow  \GRANULEnt{B}    \GRANULEsym{,}   \GRANULEmv{x_{{\mathrm{2}}}}  :_{\textcolor{coeffectColor}{  \GRANULEnt{r_{{\mathrm{1}}}}  } }   \GRANULEnt{B}    \Downarrow \vdash  \GRANULEnt{C}  \Rightarrow  \GRANULEnt{t_{{\mathrm{1}}}}  \mid  \Delta_{{\mathrm{1}}}  \GRANULEsym{,}   \GRANULEmv{x_{{\mathrm{1}}}}  :_{\textcolor{coeffectColor}{  \GRANULEnt{s_{{\mathrm{1}}}}  } }    \GRANULEnt{A} ^ \GRANULEnt{q}  \rightarrow  \GRANULEnt{B}    \GRANULEsym{,}   \GRANULEmv{x_{{\mathrm{2}}}}  :_{\textcolor{coeffectColor}{  \GRANULEnt{s_{{\mathrm{2}}}}  } }   \GRANULEnt{B}  }%
\GRANULEpremise{ \Gamma  ;   \GRANULEmv{x_{{\mathrm{1}}}}  :_{\textcolor{coeffectColor}{  \GRANULEnt{r_{{\mathrm{1}}}}  } }    \GRANULEnt{A} ^ \GRANULEnt{q}  \rightarrow  \GRANULEnt{B}    \Downarrow \vdash  \GRANULEnt{A}  \Rightarrow  \GRANULEnt{t_{{\mathrm{2}}}}  \mid  \Delta_{{\mathrm{2}}}  \GRANULEsym{,}   \GRANULEmv{x_{{\mathrm{1}}}}  :_{\textcolor{coeffectColor}{  \GRANULEnt{s_{{\mathrm{3}}}}  } }    \GRANULEnt{A} ^ \GRANULEnt{q}  \rightarrow  \GRANULEnt{B}   }%
}{
 \Gamma  ;   \GRANULEmv{x_{{\mathrm{1}}}}  :_{\textcolor{coeffectColor}{  \GRANULEnt{r_{{\mathrm{1}}}}  } }    \GRANULEnt{A} ^ \GRANULEnt{q}  \rightarrow  \GRANULEnt{B}    \Downarrow \vdash  \GRANULEnt{C}  \Rightarrow    [  \GRANULEsym{(}  \GRANULEmv{x_{{\mathrm{1}}}} \, \GRANULEnt{t_{{\mathrm{2}}}}  \GRANULEsym{)}  /  \GRANULEmv{x_{{\mathrm{2}}}}  ]  \GRANULEnt{t_{{\mathrm{1}}}}    \mid  \GRANULEsym{(}  \Delta_{{\mathrm{1}}}  \GRANULEsym{+}   \textcolor{coeffectColor}{ \GRANULEnt{s_{{\mathrm{2}}}}   \textcolor{coeffectColor}{\,\cdot\,} }    \textcolor{coeffectColor}{ \GRANULEnt{q}   \textcolor{coeffectColor}{\,\cdot\,} }  \Delta_{{\mathrm{2}}}     \GRANULEsym{)}  \GRANULEsym{,}   \GRANULEmv{x_{{\mathrm{1}}}}  :_{\textcolor{coeffectColor}{   \GRANULEnt{s_{{\mathrm{2}}}}  \GRANULEsym{+}   \GRANULEnt{s_{{\mathrm{1}}}}  \GRANULEsym{+}   \GRANULEsym{(}  \GRANULEnt{s_{{\mathrm{2}}}}  \textcolor{coeffectColor}{\,\cdot\,}   \GRANULEnt{q}  \textcolor{coeffectColor}{\,\cdot\,}  \GRANULEnt{s_{{\mathrm{3}}}}   \GRANULEsym{)}     } }    \GRANULEnt{A} ^ \GRANULEnt{q}  \multimap  \GRANULEnt{B}   }{%
{\GRANULEdruleAppFName}{}%
}}

\newcommand{\GRANULEdefnLSSynFocus}[1]{\begin{GRANULEdefnblock}[#1]{$ \Gamma  ;  \Omega  \Downarrow \vdash  \GRANULEnt{A}  \Rightarrow  \GRANULEnt{t}  \mid  \Delta $}{}
\GRANULEusedrule{\GRANULEdruleVarF{}}
\GRANULEusedrule{\GRANULEdruleAppF{}}
\end{GRANULEdefnblock}}


\newcommand{\GRANULEdefnsJudgements}{
\GRANULEdefncheckMiniDecl{}\GRANULEdefnpatternTyping{}\GRANULEdefnsynthesiseSub{}\GRANULEdefnSynthesiseAdd{}\GRANULEdefnRASynFocus{}\GRANULEdefnLASynFocus{}\GRANULEdefnRSSynFocus{}\GRANULEdefnLSSynFocus{}}

\newcommand{\GRANULEdefnss}{
\GRANULEdefnsJudgements
}

\newcommand{\GRANULEall}{\GRANULEmetavars\\[0pt]
\GRANULEgrammar\\[5.0mm]
\GRANULEdefnss}

